## How Malware Analysis Help SOC Analysts
- Stuxnet is a malware developed by US and Israeli Intelligence services to disrupt Iran's nuclear work.
- Stuxnet propagates through USB devices.
  
#### Q1: How many zero-day vulnerabilities exist in Stuxnet? (Answer should be string)
```
four
```
Searched it up on Google and this was the result.

#### Q2: Which company's industrial control systems is Stuxnet targeting?
```
Siemens
```

## Malware Definition and Malware Types
- Malware derived from the words: **malicious software**.
### Malware Types
- Backdoor
- Adware
- Ransomware
- Virus: self-replicates; infects other files on a host system.
- Worm: propagates itself to other host systems; no human intervention required.
- Rootkit
- RAT (Remote Access Trojan)
- Banking malware
- Keylogger

The answers to the questions below can be found by searching online.
#### Q1: What is the name of the first worm malware to spread on the internet?
```
Morris
```

#### Q2: What is the vulnerability code of the vulnerability used by Wannacry?
```
MS17-010
```

#### Q3: What is the name of the malware that was detected in December 2021, distributed through the Solarwinds Orion product and caused the hacking of many organizations such as FireEye?
```
SUNBURST
```

## What Should a Malware Analyst Know
### Operating System Fundamentals and Architecture
<img src="https://ld-images-2.s3.us-east-2.amazonaws.com/Malware+Analysis+Fundamentals/images/monolithic_os_kernel.gif"/>
<br>

### Assembly Language & Programming
- Processor only understand binary (0s and 1s).
	- This is machine code (assembly language).
- Preprocessor -> Compiler -> Assembler -> Executable (high to low level).
- Compilers translate code into binary so that processor can understand. 
### Network Protocols and Fundamentals
- Understanding network traffic is important for situations like connections to a C2 server, download second payloads.
### Cryptography
- Typically used for security but also to complicate things to prevent detection and access.
- Ransomware used to encrypt and prevent access to files without a ransom.

The answers to the questions below can be found by searching online.

#### Q1: Which encryption type ransomwares uses?
```
asymmetric
```

#### Q2: What is the encryption type frequently used by ransomware-type malware?
```
AES
```

#### Q3: What is the name of the software that compiles of the written codes?
```
Compiler
```

#### Q4: According to Wikipedia, in what year did assembly language first appear?
```
1947
```

#### Q5: What is the name of the software that translates machine code into assembly language?
```
Disassembler
```

## Which Approach Should You Choose When Analyzing Malware?
- Two approaches for analyzing malware:
	1. Static Analysis
	2. Dynamic Analysis
### Static Analysis
- Analyze malware by reverse engineering (w/o running them).
- Advisable to perform static analysis in a virtual OS.
- Information examined during this analysis:
	1. P.E. (Portable Executable) Headers
	2. Imported DLL's
	3. Exported DLL's
	4. CPU Instructions
### Dynamic Analysis
- Examine behavior of malware by running it.
- Consider the following events:
	1. Network Connections
	2. File Events
	3. Process Events
	4. Registry Events
<img src="https://ld-images-2.s3.us-east-2.amazonaws.com/Malware+Analysis+Fundamentals/images/static-analysis-vs-dynamic-analysis.png"/>

## Dynamic Analysis Using AnyRun
- AnyRun is an interactive sandbox used to analyze malware quickly.
- Free plan shows your analysis publicly and has restrictions such as usage time.
- PE Editors (portable executable) are tools for working with Windows files like .exe, .dll, .sys, etc.
	- Allows programs to be changed at runtime.

#### Q1: (Access AnyRun report to answer this question) What is the email address that the malware connects to the mail server to steal data?
```
logs@godforeu.com
```
If you look at the network logs, the email address used is shown.

#### Q2: (Access AnyRun report to answer this question) What is the password malware use while connecting to the mail server?
```
O8k#Pz4sk:w_
```
The password is encoded base64 so you will have to use an online decoder.

## 29 Addresses to Analyze Malware Faster
- [Anlyz](https://sandbox.anlyz.io)
- [Any.run](https://app.any.run)
- [Comodo Valkyrie](https://valkyrie.comodo.com)
- [Cuckoo](https://sandbox.pikker.ee/)
- [Hybrid Analysis](http://www.hybrid-analysis.com/)
- [Intezer Analyze](https://www.intezer.com)
- [SecondWrite Malware Deepview](https://www.secondwrite.com)
- [Jevereg](http://jevereg.amnpardaz.com/)
- [IObit Cloud](http://cloud.iobit.com)
- [BinaryGuard](http://www.binaryguard.com)
- [BitBlaze](http://bitblaze.cs.berkeley.edu/)
- [SandDroid](http://sanddroid.xjtu.edu.cn)
- [Joe Sandbox](https://www.joesandbox.com/#windows)
- [AMAaaS](https://amaaas.com/)
- [IRIS-H](https://iris-h.services/pages/dashboard#/pages/dashboard)
- [Gatewatcher Intelligence](https://intelligence.gatewatcher.com/)
- [Hatching Triage](https://tria.ge/) 
- [InQuest Labs](https://labs.inquest.net/dfi)
- [Manalyzer](https://manalyzer.org/)
- [SandBlast Analysis](https://threatpoint.checkpoint.com/ThreatPortal/emulation)
- [SNDBOX](https://app.sndbox.com/)
- [firmware](http://firmware.re/)
- [opswat](https://metadefender.opswat.com/?lang=en)
- [virusade](http://virusade.com/)
- [virustotal](https://www.virustotal.com/gui/)
- [malware config](https://malwareconfig.com/)
- [malware hunter team](https://id-ransomware.malwarehunterteam.com/)
- [virscan](http://www.virscan.org) 
- [jotti](https://virusscan.jotti.org/it)

- `WorkBook_Open()` is a function that automatically enables macro codes when the Office Document is opened.
- Python is not a debugger.
- Packers is software that makes static analysis difficult by encrypting codes of PE files.
- EAX is responsible for keeping return values of functions in x86 architecture.
